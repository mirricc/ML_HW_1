# Отчёт о выполнении домашнего задания №1 (PRO-часть)

## 1. Что было сделано (краткое описание каждого этапа)

### Этап 1: EDA (Exploratory Data Analysis)

**Задание 0**: Объяснена необходимость фиксации сидов для воспроизводимости результатов.

**Задание 1**: Проведён базовый анализ данных:
- Обнаружены пропуски в столбцах `mileage`, `engine`, `max_power`, `torque`, `seats`
- Выявлены дубликаты (985 в train, 62 в test)
- Построены дашборды с помощью `ydata-profiling`
- Сделаны выводы по распределению данных и корреляциям

**Задание 2**: Анализ статистик числовых и категориальных признаков

**Задание 3**: Удалены дубликаты (оставлены первые уникальные строки), обновлены индексы

**Задание 4**: Преобразование признаков:
- `mileage`, `engine`, `max_power` — очищены от текстовых единиц измерений
- `torque` — разделён на `torque` (в Н·м) и `max_torque_rpm`

**Задание 5**: Заполнение пропусков медианами (взятыми из train)

**Задание 6**: Приведение `engine` и `seats` к целочисленному типу

**Задание 7**: Повторный анализ статистик после обработки

### Этап 2: Визуализация и корреляция

**Задание 8**: Построены pairplot для train и test, сравнение распределений

**Задание 9**: Визуализация распределений числовых признаков

**Задание 10**: Анализ корреляций (phik-матрица, heatmap)

**Задание 11**: Визуализация категориальных признаков

### Этап 3: Предобработка данных и кодирование

**Задание 12**: OHE и Label Encoding категориальных признаков

**Задание 13**: Логарифмирование целевой переменной (`selling_price`)

**Задание 14**: Масштабирование числовых признаков

### Этап 4: Обучение моделей

**Задание 15**: Обучены модели:
- `LinearRegression`
- `Ridge`
- `Lasso`
- `RandomForestRegressor`
- `CatBoostRegressor`

**Задание 16**: Подбор гиперпараметров с помощью `RandomizedSearchCV` и `Optuna`

### Этап 5: Анализ моделей

**Задание 17**: Оценка метрик (MAE, MAPE, R²) на кросс-валидации и тесте

**Задание 18**: Анализ важности признаков для `RandomForest` и `CatBoost`

### Этап 6: Разработка сервиса

**Задание 19**: Создание веб-приложения на `Streamlit` для предсказания цены автомобиля

**Задание 20**: Деплой приложения

## 2. Какие результаты были получены (метрики + интерпретация)

| Модель | MAE (train) | MAPE (train) | R² (train) | MAE (test) | MAPE (test) | R² (test) |
|--------|-------------|--------------|------------|------------|-------------|-----------|
| LinearRegression | 88 000 | 19% | 0.79 | 90 000 | 20% | 0.78 |
| Ridge | 88 000 | 19% | 0.79 | 90 000 | 20% | 0.78 |
| Lasso | 91 000 | 20% | 0.78 | 93 000 | 21% | 0.77 |
| RandomForestRegressor | 45 000 | 10% | 0.93 | 65 000 | 14% | 0.85 |
| CatBoostRegressor | **42 000** | **9%** | **0.94** | **60 000** | **13%** | **0.87** |

**Интерпретация**:
- Лучшие результаты показал `CatBoostRegressor` с наименьшими ошибками (MAE ≈ 60 000) и высоким R² (0.87)
- Линейные модели показали скромные результаты, что говорит о нелинейной природе данных
- `RandomForest` также показал хорошее качество, но уступил `CatBoost` по всем метрикам
