# Отчёт о выполнении домашнего задания №1 (PRO-часть)

## 1. Описание выполненных работ по этапам

### Этап 1: Исследовательский анализ данных (EDA)

Был проведён предварительный анализ данных с фиксацией random seed для обеспечения воспроизводимости результатов.

**Базовый анализ данных включал:**
- Обнаружение пропущенных значений в ключевых столбцах: `mileage`, `engine`, `max_power`, `torque`, `seats`
- Выявление дубликатов в данных (985 в тренировочном наборе, 62 в тестовом)
- Построение комплексных дашбордов с помощью библиотеки `ydata-profiling`
- Анализ распределений признаков и выявление корреляционных зависимостей

**Статистический анализ:**
- Детальный анализ статистических показателей числовых и категориальных признаков
- Сравнение средних значений и медиан между тренировочной и тестовой выборками

**Очистка и подготовка данных:**
- Удаление дубликатов с сохранением первой уникальной записи
- Обновление индексации данных для обеспечения последовательной нумерации

**Преобразование признаков:**
- Очистка столбцов `mileage`, `engine`, `max_power` от текстовых единиц измерений
- Разделение признака `torque` на два числовых: крутящий момент (Н·м) и максимальные обороты двигателя

**Обработка пропущенных значений:**
- Заполнение пропусков медианами, рассчитанными на основе тренировочного набора

**Приведение типов данных:**
- Конвертация ключевых признаков к оптимальным форматам для анализа

**Итоговый анализ:**
- Повторная оценка статистических показателей после всех преобразований

### Этап 2: Визуализация и корреляционный анализ

**Парные диаграммы рассеяния:**
- Построение pairplot для тренировочного и тестового наборов данных
- Сравнительный анализ распределений между выборками

**Визуализация распределений:**
- Анализ статистических характеристик числовых признаков

**Корреляционный анализ:**
- Построение тепловых карт с использованием стандартных коэффициентов корреляции
- Применение метрики Phik для учёта числовых и категориальных зависимостей

**Анализ категориальных признаков:**
- Визуализация распределения категориальных переменных
- Оценка потенциального влияния на целевую переменную

### Этап 3: Предобработка данных и кодирование

**Кодирование категориальных признаков:**
- Применение One-Hot Encoding и Label Encoding
- Подготовка данных для алгоритмов машинного обучения

**Преобразование целевой переменной:**
- Логарифмирование `selling_price` для снижения асимметрии распределения
- Улучшение стабильности работы моделей

**Масштабирование признаков:**
- Нормализация числовых признаков к единому диапазону
- Обеспечение корректной работы масштабозависимых алгоритмов

### Этап 4: Обучение моделей машинного обучения

**Тестирование различных алгоритмов:**
 модели: LinearRegression, Ridge, Lasso, ElasticNet

### Этап 5: Анализ и оценка моделей

**Оценка качества моделей:**
- Расчёт ключевых метрик: MSE, R²
- Тестирование на независимом наборе данных

**Анализ важности признаков:**
- Определение наиболее влиятельных факторов для моделей
- Интерпретация вклада различных характеристик автомобилей в цену

### Этап 6: Разработка сервиса

**Создание веб-приложения:**
- Разработка интерактивного интерфейса на базе Streamlit
- Интеграция обученной модели для предсказания стоимости
- Deploy приложения https://mirricc-ml-hw-1-app-zlk35q.streamlit.app/

## 2. Какие результаты были получены (метрики + интерпретация)

Для оценки практической полезности моделей в реальных бизнес-условиях были применены специализированные бизнес-метрики, отражающие экономические последствия ошибок предсказания.

#### Метрика 1: Доля точных прогнозов (±10%)
Данная метрика показывает процент автомобилей, для которых предсказанная цена отличается от реальной не более чем на 10% в любую сторону. Эта метрика отражает общую точность модели.

**Результаты по моделям:**
- **Linear Regression**: 0.2200 (22.0%)
- **Ridge**: 0.2210 (22.1%)
- **Lasso**: 0.2420 (24.2%)
- **ElasticNet**: 0.2550 (25.5%)
- **Baseline (mean)**: 0.1100 (11.0%)

**Анализ:**
- ElasticNet показывает наилучший результат с 25.5% точных прогнозов
- Все регуляризованные модели превосходят базовый подход (использование среднего значения)
- Разница между лучшей и худшей моделью составляет 14.5 процентных пункта

#### Метрика 2: Асимметричная оценка переоценки/недооценки
Учитывая бизнес-контекст (продажа подержанных автомобилей), была введена асимметричная метрика:
- **Допустимая переоценка**: до +15% (можно снизить цену при переговорах)
- **Допустимая недооценка**: только до –5% (потеря потенциальной прибыли)

Эта метрика отражает реальные бизнес-риски: переоценка менее критична, чем недооценка.

**Результаты по моделям:**
- **Linear Regression**: 0.2070 (20.7%)
- **Ridge**: 0.2240 (22.4%)
- **Lasso**: 0.2370 (23.7%)
- **ElasticNet**: 0.2260 (22.6%)
- **Baseline (mean)**: 0.1040 (10.4%)

**Анализ:**
- Lasso демонстрирует наилучший результат (23.7%) с учётом бизнес-асимметрии
- Все модели показывают снижение метрики по сравнению с симметричным случаем, что ожидаемо из-за более строгих ограничений на недооценку
- Ridge и ElasticNet меняются местами в рейтинге при переходе к асимметричной оценке


## 3. Что дало наибольший прирост качества
 - наибольший прирост качества принесло логарифмирование целевой переменной

## 4. Что сделать не удалось и почему
- в рамках заданий было все реализовано

## 5. оценка разработанного сервиса
 - приложение относительно удобно в использовании, выполняет все возволоженные на него функции и ладно
 - получилось визуализировать хорошо - Гистограммы числовых признаков
 - какие улучшения планируете в следующей итерации?
   - добавить больше признаком, которые были реализованы при помощи OHE. Это позволит еще больще повысить точность модели
